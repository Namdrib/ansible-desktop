# vim: et

- name: Install packages for Fedora-based distros
  import_tasks: install_packages_fedora.yml
  become: yes
  when: ansible_facts['os_family']|lower == 'fedora' or
        ansible_facts['os_family']|lower == 'nobara' or
        ansible_facts['os_family']|lower == 'redhat'

- name: Install packages for Arch-based distros
  import_tasks: install_packages_arch.yml
  become: yes
  when: ansible_facts['os_family']|lower == 'arch' or
        ansible_facts['os_family']|lower == 'manjaro'

- name: Create Vim plugin directory
  file:
    path: "{{ ansible_env.HOME }}/.vim/autoload"
    state: directory

- name: Install VimPlug
  get_url:
    dest: "{{ ansible_env.HOME }}/.vim/autoload/plug.vim"
    url: https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim

- name: Create git repo area
  file:
    path: "{{ git_repo_dir }}"
    state: directory

- name: Clone dotfiles repo
  git:
    dest: "{{ git_repo_dir }}/dotfiles"
    repo: git@github.com:Namdrib/dotfiles
    update: yes

- name: Symlink the dotfiles repo to ~/.dotfiles
  file:
    src: "{{ git_repo_dir }}/dotfiles"
    dest: "{{ ansible_env.HOME }}/.dotfiles"
    state: link

- name: Install the dotfiles
  script: "{{ ansible_env.HOME }}/.dotfiles/install.sh"
